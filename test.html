<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RanSan eStore ‚Äì Flash Deals</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
  <style>
    /* Glassmorphism Base */
.deal-card {
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(10px);
    border-radius: 15px;
    padding: 15px 20px;
    color: #fff;
    font-family: 'Poppins', sans-serif;
    box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.deal-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 30px rgba(0,0,0,0.3);
}

.deal-title {
    font-size: 1.2rem;
    font-weight: 600;
    margin: 8px 0 4px;
}

.deal-price {
    font-size: 1rem;
    margin-bottom: 8px;
}

.deal-tag {
    font-size: 0.8rem;
    background: #ff5f6d;
    padding: 3px 8px;
    border-radius: 12px;
    display: inline-block;
    margin: 8px 0;
}

/* Flash Ticker */
.estore-deals-flash-ticker {
    position: fixed;
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
    background: linear-gradient(135deg, #ff5f6d, #ffc371);
    color: #fff;
    padding: 12px 18px;
    border-radius: 30px;
    font-size: 0.9rem;
    animation: pulseFlash 2s infinite;
    z-index: 9999;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    cursor: pointer;
    max-width: 250px;
}

@keyframes pulseFlash {
    0% { transform: translateY(-50%) scale(1); }
    50% { transform: translateY(-50%) scale(1.05); }
    100% { transform: translateY(-50%) scale(1); }
}

/* Section Containers */
.estore-deals-day,
.estore-deals-best-value,
.estore-deals-just-dropped,
.estore-deals-combo-offers {
    padding: 20px;
    border-radius: 15px;
    margin: 20px 10px;
}

.estore-deals-day {
    background: linear-gradient(45deg, #9A22F6, #6E0DD0);
}

.estore-deals-just-dropped {
    background: #222;
}

.estore-deals-combo-offers {
    background: linear-gradient(135deg, #00C6FF, #0072FF);
}

/* Grid */
.deal-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 16px;
}

/* Combo List */
.estore-deals-combo-offers ul {
    list-style: none;
    padding: 0;
}
.estore-deals-combo-offers li {
    margin-bottom: 10px;
    position: relative;
    padding-left: 25px;
}
.estore-deals-combo-offers li::before {
    content: 'üéÅ';
    position: absolute;
    left: 0;
}

/* Buy Button */
.buy-btn {
    background: #FF5F6D;
    padding: 8px 15px;
    border-radius: 20px;
    color: #fff;
    border: none;
    font-size: 0.9rem;
    cursor: pointer;
}
.buy-btn:hover {
    background: #E04B58;
}
  </style>
</head>
<body style="margin:0; background:#111; font-family:'Poppins', sans-serif; color:#fff;">

  <!-- üî• Flash Ticker -->
  <div class="estore-deals-flash-ticker"></div>

  <!-- üî• Deals of the Day -->
  <section class="estore-deals-day"></section>

  <!-- üíé Best Value Picks -->
  <section class="estore-deals-best-value"></section>

  <!-- üöÄ Just Dropped -->
  <section class="estore-deals-just-dropped"></section>

  <!-- üéÅ Combo Offers -->
  <section class="estore-deals-combo-offers"></section>

  <!-- Razorpay Script (Optional if using payment) -->
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

  <!-- JS Logic -->
  <script>
    const sheetId = '1jdD5SbymV6oNdJZSWZXsSijLcYEwsd_Kc3_Z40YB1lU';
const apiKey = 'AIzaSyD910WtP7mqTugPsEv8ZQIMUbyNxOJlDqE';
const range = 'Sheet1!A2:M';

async function loadDeals() {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`;
  const res = await fetch(url);
  const data = await res.json();

  if (!data.values) return;

  renderModules(data.values);
}

function renderModules(rows) {
  renderFlashTicker(rows);
  renderDealsOfDay(rows);
  renderBestValuePicks(rows);
  renderJustDropped(rows);
  renderComboOffers(rows);
}

function renderFlashTicker(rows) {
  const container = document.querySelector('.estore-deals-flash-ticker');
  container.innerHTML = '';

  rows.forEach(r => {
    const name = r[0];
    const disc = r[3];
    const emoji = r[11];
    const expiry = r[10];

    if (r[12] && r[12].toLowerCase() === 'yes') {
      const item = document.createElement('div');
      item.className = 'flash-item';
      item.innerHTML = `${emoji || 'üî•'} <strong>${name}</strong> - ‚Çπ${disc} ${expiry ? `| üïí ${expiry}` : ''}`;
      container.appendChild(item);
    }
  });
}

function renderDealsOfDay(rows) {
  const sec = document.querySelector('.estore-deals-day');
  sec.innerHTML = '<div class="module-header">üî• Deals of the Day</div><div class="deal-grid"></div>';

  const grid = sec.querySelector('.deal-grid');
  rows.forEach(r => {
    if (r[12] && r[12].toLowerCase() === 'yes') {
      grid.appendChild(createDealCard(r));
    }
  });
}

function renderBestValuePicks(rows) {
  const sec = document.querySelector('.estore-deals-best-value');
  sec.innerHTML = '<div class="module-header">üíé Best Value Picks</div><div class="deal-grid"></div>';

  const grid = sec.querySelector('.deal-grid');
  rows.forEach(r => {
    if (r[10] && r[10].toLowerCase().includes('value')) {
      grid.appendChild(createDealCard(r));
    }
  });
}

function renderJustDropped(rows) {
  const sec = document.querySelector('.estore-deals-just-dropped');
  sec.innerHTML = '<div class="module-header">üöÄ Just Dropped</div><div class="deal-grid"></div>';

  const grid = sec.querySelector('.deal-grid');
  rows.forEach(r => {
    if (r[10] && r[10].toLowerCase().includes('new')) {
      grid.appendChild(createDealCard(r));
    }
  });
}

function renderComboOffers(rows) {
  const sec = document.querySelector('.estore-deals-combo-offers');
  sec.innerHTML = '<div class="module-header">üéÅ Combo Offers</div><ul class="combo-list"></ul>';

  const ul = sec.querySelector('ul');
  rows.forEach(r => {
    if (r[10] && r[10].toLowerCase().includes('combo')) {
      const [name, , , disc] = r;
      const li = document.createElement('li');
      li.textContent = `${name} ‚Äì ‚Çπ${disc}`;
      ul.appendChild(li);
    }
  });
}

function createDealCard(r) {
  const [name, desc, orig, disc, img, , , , , , tag, expiry, flag] = r;

  const card = document.createElement('div');
  card.className = 'deal-card';

  card.innerHTML = `
    <img src="${img}" alt="${name}" style="width:100%;border-radius:8px;">
    <div class="deal-tag">${tag || ''}</div>
    <div class="deal-title">${name}</div>
    <div class="deal-price">‚Çπ${disc} <small style="color:gray;text-decoration:line-through;">‚Çπ${orig}</small></div>
    <button class="buy-btn" onclick="payWithRazorpay('${name}', ${disc})">Buy Now</button>
  `;

  return card;
}

window.addEventListener('load', loadDeals);

  </script>
</body>
</html>
