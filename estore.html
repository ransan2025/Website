<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description"
    content="RanSan Groups eStore ‚Äì Best digital products and deals online. Limited-time offers!">
  <meta name="keywords" content="RanSan, eStore, digital products, best deals, offers">
  <meta name="author" content="RanSan Groups">
  <title>RanSan Groups eStore</title>
  <link rel="stylesheet" href="assets/estore/style.css">
  <link rel="stylesheet" href="assets/estore/popup.css">
  <link rel="stylesheet" href="assets/estore/offer-widget.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <link rel="icon" type="image/png" href="assets/estore/RanSan_Logo_small.png">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

  <!-- Swiper CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

  <link rel="stylesheet" href="assets/estore/flash-ticker.css" />
  <link rel="stylesheet" href="assets/estore/deals-of-the-day.css">

  <!-- Open Graph Meta (For Facebook, WhatsApp, LinkedIn) -->
  <meta property="og:title" content="RanSan Groups eStore ‚Äì Digital Deals & Offers" />
  <meta property="og:description"
    content="Explore premium digital products, instant delivery & limited-time discounts!" />
  <meta property="og:image" content="https://www.ransangroups.com/assets/estore/social-share.jpg" />
  <meta property="og:url" content="https://www.ransangroups.com/estore" />
  <meta property="og:type" content="website" />

  <!-- Twitter Card Meta -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="RanSan Groups eStore ‚Äì Digital Deals & Offers" />
  <meta name="twitter:description" content="Shop the best digital products & save big at RanSan eStore." />
  <meta name="twitter:image" content="https://www.ransangroups.com/assets/estore/social-share.jpg" />

  <!-- Swiper JS -->
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>


  <style>
    html {
      scroll-behavior: smooth;
    }

    /* Make Swiper navigation buttons visible */
    .swiper-button-prev,
    .swiper-button-next {
      color: #9A22F6;
      /* RanSan primary color */
      background: rgba(255, 255, 255, 0.9);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
    }

    /* Hover effect */
    .swiper-button-prev:hover,
    .swiper-button-next:hover {
      background: #9A22F6;
      color: #fff;
    }

    /* Adjust icon size */
    .swiper-button-prev::after,
    .swiper-button-next::after {
      font-size: 18px;
    }

    /* Ensure correct z-index if overlapping */
    .swiper-button-prev,
    .swiper-button-next {
      z-index: 10;
    }

    /* Optional: Limit to deals-swiper only to avoid conflict */
    .deals-swiper .swiper-button-prev,
    .deals-swiper .swiper-button-next {
      top: 50%;
      transform: translateY(-50%);
    }

    .buy-btn {
      background: linear-gradient(to right, #9a22f6, #f96fdc);
      color: #fff;
      padding: 10px 20px;
      border-radius: 30px;
      border: none;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.2s ease;
    }

    .buy-btn:hover {
      background: linear-gradient(45deg, #B833FF, #8224E3);
      transform: translateY(-2px);
      /* ‚úÖ Subtle hover effect */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    #order-processing-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      color: #fff;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      font-size: 22px;
      font-family: Poppins, sans-serif;
    }
  </style>

</head>

<body>


  <!-- üîù Header Section -->
  <header class="site-header" id="main-header">
    <div class="header-wrapper">
      <div class="header-left">
        <img src="assets/estore/RanSan_Logo_small.png" class="logo" alt="RanSan Logo" />

        <!-- üëá Wrap title and tagline vertically -->
        <div class="site-text-group">
          <span class="site-title">RanSan eStore</span>
          <p class="site-tagline">Trusted Digital Store Since 2025</p>
        </div>
      </div>

      <div class="header-right">

        <!-- üéÅ Offer Toggle Button -->
        <button id="offersToggleBtn" class="offers-toggle-btn">üéÅ Offers</button>

        <button id="darkModeToggle" class="icon-btn">üåô</button>

        <button class="icon-btn" aria-label="Search" id="searchToggle">üîç</button>

        <div id="searchBox" style="display:none;">
          <input type="text" id="searchInput" placeholder="Search for products..."
            style="padding:5px 10px; width: 200px;">
        </div>

        <button class="icon-btn relative" aria-label="Cart">
          üõí<span class="cart-badge">3</span>
        </button>

        <!-- ‚ò∞ Hamburger for Mobile -->
        <button id="hamburgerBtn" class="icon-btn mobile-only" aria-label="Menu">‚ò∞</button>
      </div>
    </div>
  </header>

  <!-- üì± Hidden Mobile Menu -->
  <nav id="mobileMenu" class="mobile-menu">
    <ul>
      <li><a href="#dotd-container">üî• Deals</a></li>
      <li><a href="#just-dropped-section">üÜï Just Dropped</a></li>
      <li><a href="#combo-offers-section">üì¶ Combos</a></li>
      <li><a href="#lead-modal">üì± Contact</a></li>
    </ul>
  </nav>
  </header>


    <!-- Hero Section -->
<section class="hero-banner">
  <div class="hero-content">
    <h1>üöÄ Power Your Business with Premium Digital Tools</h1>
    <p class="hero-tagline">Instant Delivery. Secure Checkout. Limited-Time Offers!</p>
    <div class="hero-timer">
      ‚ö° Mega Sale Ends In: <span id="countdown">03:00:00</span>
    </div>    
    <a href="#product-section" id="rotating-cta" class="hero-cta">üõçÔ∏è Shop Now</a>
  </div>
</section>



  <!-- üì¶ Offers Panel -->
  <div id="offersPanel" class="offers-panel">
    <h3 class="offers-title">üî• Amazon Deals</h3>
    <p id="amazonDealText" class="rotating-deal">‚ö° 80% Off on Electronics</p>

    <ul class="offers-list">
      <li><a href="#amazon-banner">Upto 60% Off on Electronics</a></li>
      <li><a href="#amazon-banner">Deals on Software Tools</a></li>
      <li><a href="#amazon-banner">AI Productivity Bundles</a></li>
      <li><a href="#amazon-banner">Top Rated eBooks</a></li>
    </ul>

    <h4 class="offers-subtitle">üì± Stay Updated</h4>
    <input type="tel" placeholder="Enter mobile number" class="offer-input" />
    <button onclick="submitLead()" class="buy-btn">Submit</button>
  </div>



  <div class="category-tabs">
    <button class="category-btn active" data-category="all">All</button>
    <button class="category-btn" data-category="office">üßæ Office & Tools</button>
    <button class="category-btn" data-category="design">üßë‚Äçüé® Design & Media</button>
    <button class="category-btn" data-category="marketing">üí¨ Marketing</button>
    <button class="category-btn" data-category="ai">ü§ñ AI & Digital Tools</button>
  </div>

  <main class="product-grid"></main>

  <div class="text-center mt-4">
    <button id="loadMoreBtn" class="load-more-btn" style="display: none;">Load More</button>
  </div>





  <!-- Product Modal -->
  <div id="product-modal" class="modal">
    <div class="modal-content fade-in">
      <span class="close-button" id="close-modal">&times;</span>
      <h2 id="modal-title"></h2>
      <p id="modal-description"></p>
    </div>
  </div>





  <!-- üîΩ BUYER EMAIL/PHONE MODAL -->
  <div id="buyer-modal" class="modal" style="display:none;">
    <div class="modal-content fade-in">
      <h2>Enter Your Details</h2>
      <label>Name: <input type="text" id="buyer-name" required></label><br><br>
      <label>Email: <input type="email" id="buyer-email" required></label><br><br>
      <label>Phone: <input type="tel" id="buyer-phone" required></label><br><br>

      <!-- ‚úÖ Status message area -->
      <div id="status-msg" style="margin:10px 0; color:green;"></div>

      <button onclick="proceedToPay()">OK</button>
      <button onclick="closeBuyerModal()">Cancel</button>
    </div>
  </div>

  <iframe name="hidden_iframe" style="display:none;"></iframe>

  <style>
    .modal {
      display: none;
      /* ‚úÖ Always hidden unless toggled via JS */
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: center;
      z-index: 999;
    }

    .modal.show {
      display: flex !important;
      /* ‚úÖ Only show via JS when needed */
    }

    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 10px;
      width: 700px;
      text-align: left;
    }

    .modal-content input {
      width: 90%;
      padding: 8px;
      margin: 5px 0;
    }

    .modal-content button {
      margin: 10px 5px;
      padding: 8px 16px;
    }
  </style>

  <!-- üöÄ Deals of the Day -->
  <section id="deals-of-the-day" class="dotd-section">
    <h2 class="dotd-heading">üöÄ Deals of the Day</h2>
    <div class="dotd-grid" id="dotd-container">
      <!-- Dynamic cards will load here -->Loading deals of the day...
    </div>
  </section>
  <script src="assets/estore/deals-of-the-day.js" defer></script>


  <div id="just-dropped-section" class="just-dropped-section">
    <h3>üÜï Just Dropped</h3>
    <div id="just-dropped-container" class="just-dropped-container"></div>
  </div>

  <div id="combo-offers-section" class="combo-offers-section">
    <h3>üì¶ Combo Offers</h3>
    <div id="combo-offers-container" class="combo-offers-container"></div>
  </div>


  <section id="amazon-banner" class="amazon-banner">
    <div class="amazon-box">
      <h3>üî• Amazon Prime Day Sale</h3>
      <p>Don‚Äôt miss exclusive Prime Day deals (12-14 July)</p>
      <a href="https://amzn.to/4lwo4b0" target="_blank" class="buy-btn">Explore Deals</a>
    </div>
  </section>




  <section class="testimonials">
    <h2>Customer Love üíñ</h2>
    <div class="swiper testimonial-swiper">
      <div class="swiper-wrapper">

        <div class="swiper-slide">
          <div class="testimonial-card">
            <img src="assets/estore/user1.jpg" alt="User 1">
            <p>‚ÄúAmazing service and fast delivery!‚Äù</p>
            <strong>- Priya S.</strong>
          </div>
        </div>

        <div class="swiper-slide">
          <div class="testimonial-card">
            <img src="assets/estore/user2.jpg" alt="User 2">
            <p>‚ÄúGreat deals and smooth checkout.‚Äù</p>
            <strong>- Karthik M.</strong>
          </div>
        </div>

      </div>

      <!-- Navigation Arrows -->
      <div class="swiper-button-prev"></div>
      <div class="swiper-button-next"></div>

      <!-- Pagination Dots -->
      <div class="swiper-pagination"></div>
    </div>
  </section>



  <footer class="site-footer">
    <p>&copy; 2025 RanSan Groups. All Rights Reserved.</p>
    <div class="footer-links">
      <a href="mailto:support@ransangroups.com">üìß Email</a> |
      <a href="https://wa.me/918148610567" target="_blank">üí¨ WhatsApp</a> |
      <a href="privacy.html">Privacy</a> |
      <a href="terms.html">Terms</a>
      <a href="refund.html">Refund Policy</a> |
    </div>
  </footer>

  <script>
    function showProcessingOverlay(mainText, subText) {
      document.getElementById('order-processing-overlay').style.display = 'flex';
      document.getElementById('overlay-main-text').innerText = mainText;
      document.getElementById('overlay-sub-text').innerText = subText;
    }

    function updateOverlayText(mainText, subText) {
      document.getElementById('overlay-main-text').innerText = mainText;
      document.getElementById('overlay-sub-text').innerText = subText;
    }

    function hideProcessingOverlay() {
      document.getElementById('order-processing-overlay').style.display = 'none';
    }
  </script>

  <script>
    const sheetId = '1jdD5SbymV6oNdJZSWZXsSijLcYEwsd_Kc3_Z40YB1lU';
    const apiKey = 'AIzaSyD910WtP7mqTugPsEv8ZQIMUbyNxOJlDqE';
    const range = 'Sheet1!A2:J';
    let allProducts = [];
    let selectedProductName = "";
    let selectedPrice = 0;

    async function fetchProductData() {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`;
      const response = await fetch(url);
      const data = await response.json();
      if (data.values && data.values.length > 0) {
        allProducts = data.values;
        displayProducts(allProducts);
        renderAllDealModules(data.values); // ‚úÖ Add this line
      }
    }

    let currentIndex = 0;
    const productsPerPage = 8;
    let allFilteredProducts = [];

    function displayProductsBatch(products) {
      const grid = document.querySelector('.product-grid');
      const end = currentIndex + productsPerPage;
      const batch = products.slice(currentIndex, end);

      batch.forEach((p, index) => {
        const [name, desc, orig, disc, img, , cat, rating] = p;
        const stockLeft = Math.floor(Math.random() * 5) + 1;

        const card = document.createElement("div");
        card.className = "product-card fade-in";
        card.setAttribute("data-category", cat);
        card.style.animationDelay = `${(currentIndex + index) * 0.05}s`;

        card.innerHTML = `
      <div class="discount-badge">${Math.round(((orig - disc) / orig) * 100)}% OFF</div>
      <a href="${img}" target="_blank">
        <img src="${img}" alt="${name}" class="product-img" loading="lazy" />
      </a>
      <h2>${name}</h2>
      <div class="price-block">
        <span class="original-price">‚Çπ${orig}</span>
        <span class="discount-price">‚Çπ${disc}</span>
        <span class="discount-percent">(${Math.round(((orig - disc) / orig) * 100)}% OFF)</span>
      </div>
      <p class="stock-info">Only ${stockLeft} licenses left!</p>
      <div class="product-rating">${getStars(rating)} (${rating})</div>
      <div class="trust-note">üõ°Ô∏è 100% Secure Payment</div>
      <div class="hover-actions">
        <a href="#" class="buy-btn" onclick="payWithRazorpay('${name}', ${disc})">Buy Now</a>
        <button class="details-btn" onclick="showProductDetails('${name}', \`${desc}\`, ${disc})">üîç</button>
      </div>
    `;

        grid.appendChild(card);
      });

      currentIndex += productsPerPage;

      // Show or hide Load More button
      const loadMoreBtn = document.getElementById("loadMoreBtn");
      if (currentIndex >= products.length) {
        loadMoreBtn.style.display = "none";
      } else {
        loadMoreBtn.style.display = "inline-block";
      }
    }

    function displayProducts(products) {
      const grid = document.querySelector('.product-grid');
      grid.innerHTML = "";
      currentIndex = 0;
      allFilteredProducts = products;
      displayProductsBatch(allFilteredProducts);
    }

    document.getElementById("loadMoreBtn").addEventListener("click", () => {
      displayProductsBatch(allFilteredProducts);
    });

    function loadNextBatch() {
      const grid = document.querySelector('.product-grid');
      const loadMoreBtn = document.getElementById("loadMoreBtn");
      const end = currentIndex + batchSize;
      const batch = allFilteredProducts.slice(currentIndex, end);

      batch.forEach((p, index) => {
        const [name, desc, orig, disc, img, , cat, rating] = p;
        const stockLeft = Math.floor(Math.random() * 5) + 1;

        const card = document.createElement("div");
        card.className = "product-card fade-in";
        card.setAttribute("data-category", cat);
        card.style.animationDelay = `${(currentIndex + index) * 0.05}s`;

        card.innerHTML = `
      <div class="discount-badge">${Math.round(((orig - disc) / orig) * 100)}% OFF</div>

      <a href="${img}" target="_blank">
        <img src="${img}" alt="${name}" class="product-img" loading="lazy" />
      </a>

      <h2>${name}</h2>

      <div class="price-block">
        <span class="original-price">‚Çπ${orig}</span>
        <span class="discount-price">‚Çπ${disc}</span>
      </div>

      <p class="stock-info">Only ${stockLeft} licenses left!</p>

      <div class="product-rating">‚≠ê ${rating}</div>

      <div class="trust-note">üõ°Ô∏è 100% Secure Payment</div>

      <div class="hover-actions">
        <a href="#" class="buy-btn" onclick="payWithRazorpay('${name}', ${disc})">Buy Now</a>
        <button class="details-btn" onclick="showProductDetails('${name}', \`${desc}\`, ${disc})">üîç</button>
      </div>
    `;

        grid.appendChild(card);
      });

      currentIndex += batchSize;

      if (currentIndex >= allFilteredProducts.length) {
        loadMoreBtn.style.display = "none";
      }

      calculateDiscounts?.();
    }

    function updateCountdown() {
      const targetDate = new Date("July 27, 2025 23:59:59").getTime();
      const timer = setInterval(() => {
        const now = new Date().getTime();
        const diff = targetDate - now;

        if (diff < 0) {
          document.getElementById("countdown").innerHTML = "Expired";
          clearInterval(timer);
          return;
        }

        const d = Math.floor(diff / (1000 * 60 * 60 * 24));
        const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const s = Math.floor((diff % (1000 * 60)) / 1000);

        document.getElementById("countdown").innerHTML = `
      <span>${d}d</span><span>${h}h</span><span>${m}m</span><span>${s}s</span>
    `;
      }, 1000);
    }
    window.addEventListener('load', updateCountdown);

    function calculateDiscounts() {
      document.querySelectorAll('.price-block').forEach(b => {
        const orig = parseFloat(b.dataset.original);
        const disc = parseFloat(b.dataset.discount);
        if (orig > disc) {
          const pct = Math.round(((orig - disc) / orig) * 100);
          b.querySelector('.discount-percent').textContent = `(${pct}% OFF)`;
        }
      });
    }

    function showDetails(title, desc) {
      document.getElementById('modal-title').textContent = title;
      document.getElementById('modal-description').innerHTML = desc.replace(/\n/g, "<br>");
      document.getElementById('product-modal').style.display = 'flex';

      // ‚úÖ Show sticky buy bar on mobile
      const buyBar = document.getElementById('mobile-buy-bar');
      buyBar.classList.remove('hidden');

      // Handle Buy button click
      document.getElementById('mobile-buy-btn').onclick = function () {
        payWithRazorpay(title, selectedPrice); // Use your existing function
      };
    }

    document.getElementById('close-modal').onclick = () => {
      document.getElementById('product-modal').style.display = 'none';

      // ‚úÖ Hide sticky buy bar when modal closes
      document.getElementById('mobile-buy-bar').classList.add('hidden');
    };

    window.onclick = function (e) {
      if (e.target.id === "buyer-modal") {
        document.getElementById('buyer-modal').classList.remove('show');
      }
      if (e.target.id === "product-modal") {
        document.getElementById('product-modal').style.display = 'none';
      }
    }

    // üîΩ MODAL EMAIL/CHECKOUT HANDLING
    function payWithRazorpay(productName, price) {
      selectedProductName = productName;
      selectedPrice = price;
      document.getElementById('buyer-modal').classList.add('show');
    }
    function closeBuyerModal() {
      document.getElementById('buyer-modal').classList.remove('show');
    }



    async function proceedToPay() {
      const name = document.getElementById("buyer-name").value.trim();
      const email = document.getElementById("buyer-email").value.trim();
      const phone = document.getElementById("buyer-phone").value.trim();
      const status = document.getElementById("status-msg");

      if (!name || !email || !phone) {
        status.innerText = "‚ö†Ô∏è Please fill all fields.";
        return;
      }

      status.innerText = "‚è≥ Capturing your details...";

      const uniqueTimestamp = new Date().toISOString();

      const leadData = {
        name: name,
        email: email,
        phone: phone,
        product: selectedProductName,
        amount: selectedPrice,
        intent: "Interested - Not Paid Yet",
        payment_id: "",
        timestamp: uniqueTimestamp
      };

      try {
        await fetch("https://script.google.com/macros/s/AKfycbxYnypoWta9wv27RDEi_iPI_ISn3ZeRCW-RW_bNW8h3YBysU5HPtu1BGekR2-yhUytkaQ/exec", {
          method: "POST",
          body: JSON.stringify(leadData)
        });
      } catch (e) {
        console.log("Lead save failed, proceeding to payment anyway.");
      }

      // Close buyer modal
      document.getElementById('buyer-modal').classList.remove('show');

      // Show overlay for processing
      showProcessingOverlay("‚è≥ Processing Payment", "Please wait, do not refresh the page...");

      const options = {
        key: "rzp_test_iOdWWEhKlikqRy",
        amount: selectedPrice * 100,
        currency: "INR",
        name: "RanSan Groups",
        description: selectedProductName,

        handler: async function (response) {
          console.log("Razorpay handler fired");

          // Show success message
          showProcessingOverlay("‚úÖ Payment Successful", "‚è≥ Generating Invoice & Delivery...");

          const paidData = {
            name: name,
            email: email,
            phone: phone,
            product: selectedProductName,
            amount: selectedPrice,
            intent: "Paid Order",
            payment_id: response.razorpay_payment_id,
            timestamp: uniqueTimestamp
          };

          try {
            await fetch("https://script.google.com/macros/s/AKfycbxYnypoWta9wv27RDEi_iPI_ISn3ZeRCW-RW_bNW8h3YBysU5HPtu1BGekR2-yhUytkaQ/exec", {
              method: "POST",
              body: JSON.stringify(paidData)
            });

            const postData = new URLSearchParams({
              name: paidData.name,
              email: paidData.email,
              phone: paidData.phone,
              product: paidData.product,
              amount: paidData.amount,
              payment_id: paidData.payment_id
            });

            const res = await fetch("https://script.google.com/macros/s/AKfycbzswQFu7aSP_JQN4bKh-4MOXxo77dLcMDAL-lc8HJK7TN-oCaqHr4B1i2UXkFrzCbV4/exec", {
              method: "POST",
              body: postData
            });

            const text = await res.text();

            if (text.includes("Success")) {
              showProcessingOverlay("‚úÖ Order Completed!", "üéÅ Delivery sent to Email & WhatsApp. Redirecting...");
              setTimeout(() => {
                window.location.href = "https://www.ransangroups.com/thank-you.html";
              }, 3000);
            } else {
              showProcessingOverlay("‚ö†Ô∏è Invoice Failed", "Payment succeeded but delivery failed. Please contact support.");
            }

          } catch (err) {
            console.error(err);
            showProcessingOverlay("‚ùå Post-processing Failed", "Payment captured, but delivery failed. Contact support.");
          }
        },

        modal: {
          ondismiss: function () {
            console.log("User closed Razorpay without paying");
            showProcessingOverlay("‚ùå Payment Cancelled", "You have closed the payment. No amount was deducted.");

            setTimeout(() => {
              window.location.reload();
            }, 3000);
          }
        },

        prefill: {
          name: name,
          email: email,
          contact: phone
        },

        theme: { color: "#9A22F6" }
      };

      try {
        const rzp = new Razorpay(options);
        rzp.open();
      } catch (err) {
        alert("‚ö†Ô∏è Razorpay could not load. Check your key or internet connection.");
        hideProcessingOverlay();
      }
    }

    document.querySelectorAll('.category-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const cat = btn.getAttribute('data-category');
        const filtered = cat === "all" ? allProducts : allProducts.filter(p => p[6] === cat);
        displayProducts(filtered);
      });
    });

    //window.onload = fetchProductData;

    document.getElementById("loadMoreBtn").addEventListener("click", loadNextBatch);

    window.addEventListener('load', function () {
      updateCountdown();
      fetchProductData();

      setTimeout(() => {
        document.getElementById('lead-modal').style.display = 'flex';
      }, 3000);
    });

    function getStars(r) {
      const f = '‚òÖ'.repeat(Math.floor(r));
      const h = (r % 1 >= 0.5) ? '¬Ω' : '';
      const e = '‚òÜ'.repeat(5 - Math.ceil(r));
      return f + h + e;
    }
  </script>

  <script>
    window.addEventListener("error", function (e) {
      if (e?.error?.message?.includes("Razorpay")) {
        alert("‚ö†Ô∏è Razorpay Error: Check your internet or API key.");
      } else {
        console.warn("JS Error ignored:", e.message);
      }
    });
  </script>

  <script>
    var swiper = new Swiper('.testimonial-swiper', {
      loop: true,
      autoplay: {
        delay: 3000,
        disableOnInteraction: false,
      },
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
    });
  </script>

  <script>
    function closeLeadModal() {
      document.getElementById('lead-modal').style.display = 'none';
    }

    async function submitLead() {
      const phone = document.getElementById('lead-phone').value.trim();
      const msg = document.getElementById('lead-msg');

      if (!phone) {
        msg.innerText = "‚ö†Ô∏è Please enter your WhatsApp number.";
        return;
      }

      msg.innerText = "‚è≥ Submitting...";

      const leadData = {
        name: "",
        email: "",
        phone: phone,
        intent: "Newsletter/WhatsApp Lead",
        product: "",
        amount: "",
        payment_id: "",
        timestamp: new Date().toISOString()
      };

      try {
        // News leed URL
        await fetch("https://script.google.com/macros/s/AKfycbxYnypoWta9wv27RDEi_iPI_ISn3ZeRCW-RW_bNW8h3YBysU5HPtu1BGekR2-yhUytkaQ/exec", {
          method: "POST",
          body: JSON.stringify(leadData)
        });

        // üîΩ Send WhatsApp Welcome Message
        await sendWhatsAppMessage(phone, "üéâ Thank you for subscribing to RanSan Groups Deals! We‚Äôll send you exclusive discounts soon.");

        msg.innerText = "‚úÖ Thank you! We will notify you on WhatsApp.";
        setTimeout(() => {
          document.getElementById('lead-modal').style.display = 'none';
        }, 2000);
      } catch (e) {
        msg.innerText = "‚ùå Submission failed. Try again.";
      }
    }

  </script>


  <script>
    async function sendWhatsAppMessage(phone, message) {
      console.log("Preparing to send WhatsApp follow-up via Proxy");

      // whatspp follow
      const proxyUrl = "https://script.google.com/macros/s/AKfycbzT24BfbjJ8xD051REQIR6fsUZuTiEGCqCYE40ciJtUaQTO0Q9K7LsTyj2BB8kPKOvBaQ/exec?action=sendFollowup";

      const payload = {
        phone: phone,
        message: message
      };

      const response = await fetch(proxyUrl, {
        method: "POST",
        body: JSON.stringify(payload)
      });

      const result = await response.text();
      console.log("Proxy Response:", result);
    }
  </script>

  <script>
    function showDetailsModal(title, desc) {
      document.getElementById('modal-title').innerText = title;
      document.getElementById('modal-description').innerText = desc;
      document.getElementById('details-modal').style.display = 'flex';
    }

    function closeDetailsModal() {
      document.getElementById('details-modal').style.display = 'none';
    }
  </script>

  <script>
    function showProductDetails(name, desc, price) {
      document.getElementById('modal-product-name').innerText = name;
      document.getElementById('modal-product-desc').innerText = desc;

      document.getElementById('modal-buy-btn').onclick = function () {
        payWithRazorpay(name, price);
        closeProductModal(); // Close zoom modal before opening buyer modal
      };

      document.getElementById('product-details-modal').style.display = 'flex';
    }

    function closeProductModal() {
      document.getElementById('product-details-modal').style.display = 'none';
    }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

  <script>
    var swiper = new Swiper('.testimonial-swiper', {
      loop: true,
      autoplay: {
        delay: 4000,
        disableOnInteraction: false,
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
    });
  </script>


  <script>
    // Define CTA options (Text + Target Section)
    const ctaOptions = [
      { text: "Deals of the Day", target: "deals-of-the-day" },
      { text: "Just Dropped", target: "just-dropped-section" },
      { text: "Combo Offers", target: "combo-offers-section" },
      { text: "Amazon Sale", target: "amazon-banner" }
    ];

    let ctaIndex = 0;
    const ctaButton = document.getElementById('rotating-cta');

    // Function to update CTA text
    function updateCTA() {
      ctaButton.innerText = ctaOptions[ctaIndex].text;
    }

    // Rotate text every 4 seconds
    setInterval(() => {
      ctaIndex = (ctaIndex + 1) % ctaOptions.length;
      updateCTA();
    }, 4000);

    // Initial load
    updateCTA();

    // Handle click event
    ctaButton.addEventListener('click', () => {
      const targetId = ctaOptions[ctaIndex].target;
      const element = document.getElementById(targetId);
      if (element) {
        // If it's a modal, open it
        if (element.classList.contains('modal')) {
          element.style.display = 'flex';
        } else {
          // Scroll to section
          element.scrollIntoView({ behavior: "smooth" });
        }
      }
    });
  </script>

  <script>
    // Show the mobile buy bar only on mobile after page load
    window.addEventListener('load', function () {
      const mobileBtn = document.getElementById('mobile-buy-btn');
      const hotDeals = document.getElementById('hot-deals-slider');

      if (window.innerWidth <= 767 && mobileBtn) {
        document.getElementById('mobile-buy-bar').classList.remove('hidden');

        mobileBtn.addEventListener('click', function () {
          if (hotDeals) {
            hotDeals.scrollIntoView({ behavior: 'smooth' });
          }
        });
      }
    });
  </script>

  <script>
    function animateDealsOfDayCards() {
      const cards = document.querySelectorAll('.dotd-card');
      cards.forEach((card, i) => {
        setTimeout(() => {
          card.classList.add('animate-in');
        }, i * 200); // Staggered animation: 0.2s between cards
      });
    }
  </script>

  <script>
    async function loadJustDropped() {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${dealSheetId}/values/${dealRange}?key=${dealApiKey}`;
      try {
        const res = await fetch(url);
        const data = await res.json();
        const rows = data.values;
        const container = document.getElementById("just-dropped-container");
        if (!container || !rows) return;

        const nameCol = 16, imgCol = 17;
        const valid = rows.filter(r => r[nameCol] && r[imgCol]);

        container.innerHTML = valid.map(r => `
      <div class="just-dropped-card">
        <img src="${r[imgCol]}" alt="${r[nameCol]}">
        <div class="just-dropped-name">üÜï ${r[nameCol]}</div>
      </div>
    `).join("");
      } catch (err) {
        console.error("Just Dropped Error:", err);
      }
    }
  </script>

  <script>
    async function loadComboOffers() {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${dealSheetId}/values/${dealRange}?key=${dealApiKey}`;
      try {
        const res = await fetch(url);
        const data = await res.json();
        const rows = data.values;
        const container = document.getElementById("combo-offers-container");
        if (!container || !rows) return;

        const descCol = 18, priceCol = 19;
        const valid = rows.filter(r => r[descCol] && r[priceCol]);

        container.innerHTML = valid.map(r => `
      <div class="combo-offer-card">
        <div class="combo-desc">${r[descCol]}</div>
        <div class="combo-price">üí∞ ${r[priceCol]}</div>
      </div>
    `).join("");
      } catch (err) {
        console.error("Combo Offers Error:", err);
      }
    }
  </script>

  <script>
    window.addEventListener("DOMContentLoaded", () => {
      loadJustDropped();
      loadComboOffers();
    });
  </script>


  <script>
    window.addEventListener('scroll', function () {
      const header = document.getElementById('main-header');
      if (window.scrollY > 20) {
        header.classList.add('scrolled');
      } else {
        header.classList.remove('scrolled');
      }
    });
  </script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const hamburger = document.getElementById('hamburgerBtn');
      const menu = document.getElementById('mobileMenu');

      if (hamburger && menu) {
        hamburger.addEventListener('click', () => {
          menu.classList.toggle('open');
        });
      }
    });
  </script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const toggleBtn = document.getElementById("searchToggle");
      const searchBox = document.getElementById("searchBox");
      const searchInput = document.getElementById("searchInput");

      // Show/hide search input on icon click
      toggleBtn.addEventListener("click", () => {
        if (searchBox.style.display === "none") {
          searchBox.style.display = "block";
          searchInput.focus();
        } else {
          searchBox.style.display = "none";
        }
      });

      // Filter products as you type
      searchInput.addEventListener("input", function () {
        const keyword = this.value.toLowerCase();
        const filtered = allProducts.filter(p =>
          p[0]?.toLowerCase().includes(keyword) ||
          p[1]?.toLowerCase().includes(keyword)
        );
        displayProducts(filtered);
      });
    });
  </script>

  <script>
    function getStars(rating) {
      const fullStars = Math.floor(rating);
      const stars = "‚≠ê".repeat(fullStars);
      const empty = "‚òÜ".repeat(5 - fullStars);
      return stars + empty;
    }
  </script>

  <!--offer widge-->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const toggleBtn = document.getElementById("offersToggleBtn");
      const offerPanel = document.getElementById("offersPanel");

      // ‚úÖ Toggle panel on click
      toggleBtn.addEventListener("click", (e) => {
        e.stopPropagation();
        offerPanel.classList.toggle("show");
      });

      // ‚úÖ Close panel on outside click
      document.addEventListener("click", (e) => {
        if (!offerPanel.contains(e.target) && !toggleBtn.contains(e.target)) {
          offerPanel.classList.remove("show");
        }
      });

      // ‚úÖ ESC key to close
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") {
          offerPanel.classList.remove("show");
        }
      });

      // ‚úÖ Deal rotator (if #amazonDealText exists)
      const amazonDeals = [
        "‚ö° 80% Off on Electronics",
        "üéß Noise Cancelling Headphones ‚Çπ1,999",
        "üì± Best Phones Under ‚Çπ10K",
        "üíª Top Laptops Deals",
        "üì¶ Combo: Amazon + Flipkart + Meesho"
      ];
      const dealTextEl = document.getElementById("amazonDealText");
      if (dealTextEl) {
        setInterval(() => {
          const random = Math.floor(Math.random() * amazonDeals.length);
          dealTextEl.textContent = `üî• ${amazonDeals[random]}`;
        }, 5000);
      }

      // ‚úÖ Handle submit button
      const submitBtn = offerPanel.querySelector("button.buy-btn");
      submitBtn.addEventListener("click", () => {
        const input = offerPanel.querySelector("input.offer-input");
        const number = input.value.trim();
        if (number.length >= 10) {
          submitLead(number); // ‚úÖ Calls your existing function

          // ‚úÖ Clear old message if exists
          const existingMsg = offerPanel.querySelector(".offer-success-msg");
          if (existingMsg) existingMsg.remove();

          // ‚úÖ Show success message above the button
          const successMsg = document.createElement("div");
          successMsg.textContent = "‚úÖ Thank you! You'll be notified soon.";
          successMsg.className = "offer-success-msg";
          offerPanel.insertBefore(successMsg, submitBtn);

          // ‚úÖ Clear input
          input.value = "";

          // ‚úÖ Auto-hide after 3s
          setTimeout(() => {
            offerPanel.classList.remove("show");
            successMsg.remove();
          }, 3000);
        } else {
          alert("Please enter a valid mobile number.");
        }
      });
    });
  </script>

  <!--offer widge-->

  <!--Scroll-->
  <script>
    window.addEventListener("scroll", () => {
      document.getElementById("backToTop").style.display = window.scrollY > 500 ? "block" : "none";
    });
    document.getElementById("backToTop").addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  </script>
  <!--Scroll-->

  <!--Scrolling progress-->
<script>
  window.addEventListener("scroll", () => {
  const scrollTop = window.scrollY;
  const docHeight = document.body.scrollHeight - window.innerHeight;
  const scrolled = (scrollTop / docHeight) * 100;
  document.getElementById("scrollProgress").style.width = `${scrolled}%`;
});
</script>

  <!--Scrolling progress-->

<!--Dark Mode-->
<script>
  document.getElementById("darkModeToggle").addEventListener("click", () => {
  document.body.classList.toggle("dark-mode");
});
</script>
<!--Dark Mode-->


  <!-- Mobile Sticky Buy Bar -->
  <div id="mobile-buy-bar" class="mobile-buy-bar hidden">
    <button id="mobile-buy-btn">üî• View Hot Deals</button>
  </div>

  <a href="https://wa.me/918148610567" class="whatsapp-float" target="_blank">
    <img src="assets/estore/whatsapp-icon.png" alt="WhatsApp" style="width:50px; height:50px;">
  </a>

  <div id="details-modal" class="modal">
    <div class="modal-content">
      <span class="close-button" onclick="closeDetailsModal()">&times;</span>
      <h2 id="modal-title"></h2>
      <p id="modal-description"></p>
    </div>
  </div>

  <div id="product-details-modal" class="modal">
    <div class="modal-content">
      <button class="close-button" onclick="closeProductModal()">√ó</button>

      <h2 id="modal-product-name"></h2>

      <!-- Make this content scrollable -->
      <div class="modal-description-wrapper">
        <p id="modal-product-desc"></p>
      </div>

      <button class="buy-btn" id="modal-buy-btn">üõí Buy Now</button>
    </div>
  </div>

  <!-- Popup Notification -->
  <div id="popup" class="popup"></div>

  <!-- Include the Popup Script -->
  <script src="assets/estore/popup.js"></script>


  <!-- üî• Flash Deals (Ticker Floating Widget) -->
  <div id="flash-deals-ticker" class="fd-ticker">
    <div class="fd-ticker-content">Loading deals...</div>
  </div>
  <script src="assets/estore/flash-ticker.js" defer></script>


  <div id="order-processing-overlay" style="display: none;">
    <div id="overlay-main-text">‚úÖ Payment Successful</div>
    <div id="overlay-sub-text">‚è≥ Generating Invoice & Sending Delivery Details...</div>
  </div>


  <button id="backToTop" class="back-to-top">‚¨ÜÔ∏è</button>

<div id="scrollProgress"></div>

<button id="darkModeToggle">üåô</button>

</body>

</html>